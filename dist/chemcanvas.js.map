{"version":3,"sources":["../src/intro.js","../.tmp/es5/.tmp/es6/concat.js","../src/outro.js"],"names":[],"mappings":"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","file":"chemcanvas.js","sourcesContent":["(function(root) {","export default\nclass Canvas {\n\n  constructor(renderer) {\n    this.renderer = renderer;\n    renderer.world = new LiThree.World();\n    this.atoms = [];\n    this._display = false;\n    this._displays = [];\n\n    this._attachInteractive();\n  }\n\n  attach(molecule) {\n\n    var i;\n\n    for (i in molecule.atoms) {\n      let atom = molecule.atoms[i];\n      this.addAtom(atom);\n    }\n\n\n  }\n\n  addAtom(atom) {\n    this.atoms.push(atom);\n    var i;\n\n    atom.on('bond', function (bond) {\n\n    });\n\n    this._display.drawAtom(atom);\n\n    for (i in atom.bonds) {\n      let bond = atom.bonds[i];\n      this._display.drawBond(bond);\n    }\n  }\n\n  setDisplay(display) {\n    for (var i in this._displays) {\n      let _display = this._displays[i];\n\n      if (_display instanceof display) {\n        this._display = _display;\n        return;\n      }\n    }\n\n    this._display = new display(this);\n    this._display.create();\n    this._displays.push(this._display);\n  }\n\n  _attachInteractive() {\n    var renderer = this.renderer;\n    var interactive = new LiThree.Interactive(renderer);\n\n    this.interactive = interactive;\n  }\n\n  show() {\n    this.renderer.draw();\n    var _this = this;\n    requestAnimationFrame(function () {\n      _this.show();\n    });\n  }\n\n}\nexport default\nclass BaseDisplay {\n\n  constructor(canvas) {\n    this.canvas = canvas;\n    this._atoms = [];\n  }\n\n  drawAll() {\n\n  }\n\n}\nimport BaseDisplay from '_base.js';\n\nvar BAS_KEY = 'ball-and-stick';\n\nexport default\nclass BallAndStick extends BaseDisplay {\n\n  constructor(canvas) {\n    this.light = false;\n    super(canvas);\n  }\n\n  drawLight() {\n    var light = new LiThree.Light.Point();\n\n    light.position.x = -30;\n    light.position.z = -60;\n    light.position.y = -30;\n\n    this.light = light;\n  }\n\n  drawAtom(atom) {\n    var renderer = this.canvas.renderer,\n      world = renderer.world;\n\n    var position = atom.position;\n\n    var radius = Math.exp(-Math.pow(atom.element.atomicRadius - 91, 2) / 500) * atom.element.atomicRadius / 100;\n\n    var sphere = LiThree.ObjectFactory.Sphere(radius, 50, 50);\n\n    //sphere.drawingMode = LiThree.Common.drawingMode.LINES;\n    sphere.position.copy(position);\n    sphere.position.multiply(2);\n\n    sphere.material.color.hex = atom.element.color;\n\n    world.add(sphere);\n\n    var elements = {\n      sphere: sphere,\n      position: sphere.position,\n      color: sphere.material.color,\n      radius: radius\n    };\n\n    atom.setData(BAS_KEY, elements);\n  }\n\n  drawBond(bond) {\n    var elements;\n    if (bond.hasData(BAS_KEY)) {\n      elements = bond.getData(BAS_KEY);\n    } else {\n      elements = {\n        cylinders: []\n      };\n      bond.setData(BAS_KEY, elements);\n    }\n\n    var renderer = this.canvas.renderer,\n      world = renderer.world,\n      begin = bond.begin,\n      end = bond.end,\n      beginD = begin.getData(BAS_KEY),\n      endD = end.getData(BAS_KEY);\n\n    if(! beginD || ! endD) {\n      return;\n    }\n\n    var beginP = beginD.position,\n      endP = endD.position,\n      beginC = beginD.color,\n      endC = endD.color,\n      distance = beginP.distance(endP),\n      middle = beginP.clone().add(endP).divide(2),\n      deltaX = endP.x - beginP.x,\n      deltaY = endP.y - beginP.y,\n      deltaZ = endP.z - beginP.z,\n      d = 0.1;\n\n    var rotation = new LiThree.Math.Quaternion();\n    rotation.rotateZ(Math.atan2(deltaY, deltaX));\n    rotation.rotateY(-Math.asin(deltaZ / distance));\n\n    var c = (bond.order - 1) * d;\n\n    for (var i = 0; i < bond.order; i++) {\n      let cylinder = LiThree.ObjectFactory.Cylinder(distance, d, d);\n      cylinder.material.color = beginC;\n      this._programCylinderShader(cylinder, endC);\n      elements.cylinders.push(cylinder);\n\n      world.add(cylinder);\n    }\n\n    for(var j in elements.cylinders) {\n      let cylinder = elements.cylinders[j];\n\n      cylinder.rotation = rotation;\n      cylinder.position.copy(middle);\n      cylinder.position.y += j * 0.2 - c;\n    }\n\n  }\n\n  _programCylinderShader(cylinder, endC) {\n    renderer.initShape(cylinder);\n\n    cylinder.shader.fragmentProgram.clear();\n\n    cylinder.shader.fragmentProgram.code(`vec3 effectiveColor = halfColor > 0.5 ? vColor : %c2; gl_FragColor = vec4(%lw + effectiveColor, 1.0);`, {\n      c2: cylinder.shader.fragmentProgram.uniform('vec3', function () {\n        this.value(endC.toArray());\n      }),\n      hc: cylinder.shader.fragmentProgram.varying('float', 'halfColor'),\n      lw: 'lightWeight'\n    });\n\n    cylinder.shader.vertexProgram.code(`%hc = %vp.x < 0.5 ? 1.0 : 0.0;`, {\n      lw: 'lightWeight',\n      vp: 'vPosition',\n      hc: cylinder.shader.vertexProgram.varying('float', 'halfColor')\n    });\n\n    cylinder.shader.create();\n  }\n\n  create() {\n    this.drawLight();\n    this.up();\n  }\n\n  up() {\n    var world = renderer.world;\n\n    world.add(this.light);\n  }\n\n  down() {\n    var world = renderer.world;\n\n    world.remove(this.light);\n  }\n\n}\n//# sourceMappingURL=concat.js.map","root.ChemCanvas = {\n  Canvas: Canvas,\n  Display: {\n    BallAndStick: BallAndStick\n  }\n};\n})\n(this);"]}